//User Profiles
[
{
"$lookup":{
    "from": "locations",
    "localField": "personal_info.current_city_id",
    "foreignField": "_id",
    "as": "currentCity"
}
},
{
"$lookup":{
    "from": "normalized_title",
    "localField": "personal_info.normalized_profile_title",
    "foreignField": "title",
    "as": "normalizedtitle"
}
},
{
"$lookup":{
    "from": "standardized_titles",
    "localField": "normalizedtitle.standardized_title_id",
    "foreignField": "_id",
    "as": "standardizedtitle"
}
},
{"$unwind":"$personal_info"},
{"$unwind":"$biolets"},
 {"$project" :
    {"Name":"$personal_info.name", "_id" : 0, "ProfileTitle":"$personal_info.profile_title", "emails" : 1, "ln_profile_url" :1, "Institute":"$biolets.institute_name", "Graduation_Year":"$biolets.to_year", "Normalized_title:":"$personal_info.normalized_profile_title",
    "City":"$currentCity.name", "Country":"$currentCity.country_name", "Standard Title":"$standardizedtitle.title", "FunctionalArea":"$standardizedtitle.functional_area"

}}
]
//--------------------------------------------------------------------------------------------------------------------------------------
//User profiles of all who applied for atleast one job

[{
"$lookup":{
    "from": "job_referral_infos",
    "localField": "_id",
    "foreignField": "candidate_id",
    "as": "userProfile"
}
},
{
"$lookup":{
    "from": "locations",
    "localField": "personal_info.current_city_id",
    "foreignField": "_id",
    "as": "currentCity"
}
},
{
"$lookup":{
    "from": "normalized_title",
    "localField": "personal_info.normalized_profile_title",
    "foreignField": "title",
    "as": "normalizedtitle"
}
},
{
"$lookup":{
    "from": "standardized_titles",
    "localField": "normalizedtitle.standardized_title_id",
    "foreignField": "_id",
    "as": "standardizedtitle"
}
},
 {"$project" :
    {"personal_info.name" : 1, "_id" : 0, "personal_info.profile_title" : 1, "emails" : 1, "ln_profile_url" :1, "biolets.institute_name":1, "biolets.to_year":1, "personal_info.normalized_profile_title":1,
    "currentCity.name":1, "currentCity.country_name":1, "standardizedtitle.title":1, "standardizedtitle.functional_area":1

}}
]
//----------------------------------------------------------------------------------------------------------------------------------------
//Users who have uploaded their resumes through job peferences

[{
"$lookup":{
    "from": "job_referral_infos",
    "localField": "_id",
    "foreignField": "candidate_id",
    "as": "userProfile"
}
},
{
"$lookup":{
    "from": "locations",
    "localField": "personal_info.current_city_id",
    "foreignField": "_id",
    "as": "currentCity"
}
},
{
"$lookup":{
    "from": "normalized_title",
    "localField": "personal_info.normalized_profile_title",
    "foreignField": "title",
    "as": "normalizedtitle"
}
},
{
"$lookup":{
    "from": "standardized_titles",
    "localField": "normalizedtitle.standardized_title_id",
    "foreignField": "_id",
    "as": "standardizedtitle"
}
},
{
"$lookup":{
    "from": "aux_users",
    "localField": "_id",
    "foreignField": "user_id",
    "as": "job_pref_resume"
}
},
{"$match":{"$ne":["$job_pref_resume.job_preference",null]}},
 {"$project" :
    {"personal_info.name" :1,
    "_id" : 0,
    "personal_info.profile_title" :1,
    "emails" : 1,
    "ln_profile_url" :1,
    "biolets.institute_name":1,
    "biolets.to_year":1,
    "personal_info.normalized_profile_title":1,
    "currentCity.name":1,
    "currentCity.country_name":1,
    "standardizedtitle.title":1,
    "standardizedtitle.functional_area":1

}}
]
//---------------------------------------------------------------------------
//Default fields for networks
[{"$unwind":"$institution_streams"},
{"$match":{"institution_streams.is_primary":true}},
 {
     "$project":{
         "_id":0, "name":1,"host":1,"user_count":1, "institution_streams.name":1, "institution_streams.rank":1
         
     }
    }
]
